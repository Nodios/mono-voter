(this.webpackJsonpvoter=this.webpackJsonpvoter||[]).push([[0],{67:function(e,t,n){e.exports=n(96)},72:function(e,t,n){},96:function(e,t,n){"use strict";n.r(t);var r,a=n(0),o=n.n(a),i=n(24),s=n.n(i),c=(n(72),n(12)),u=n(11),l=n(20),p=n(21),b=n(22),h=n(13),d=n(25),f=n(126),m=n(127),v=n(34),j=n(128),O=n(112),y=n(129),w=n(7),g=Object(h.observer)(r=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,"Welcome")}}]),t}(o.a.Component))||r,E=n(14),S=n.n(E),k=n(23),q=n(121),x=n(57),I=n(113),R=n(114),C=n(117),z=n(118),A=n(119),D=n(120),U=n(115),_=n(116),F=n(111),N=n(45),P=[{name:"home",pattern:"/"},{name:"questions",pattern:"/questions"},{name:"admin",pattern:"/admin"}],V=new d.RouterState("notFound"),L=function e(){Object(c.a)(this,e),this.routerStore=new d.RouterStore(this,P,V),this.questionsStore=new ge(this)},W=n(18),G=n(10),M=(n(49),n(5)),B=n(50),T=n.n(B);T.a.initializeApp({apiKey:"AIzaSyBjqj1Ge9e3lgX1q3MeZCm8UzjQLa9qCwI",authDomain:"voter-ccc7c.firebaseapp.com",databaseURL:"https://voter-ccc7c.firebaseio.com",projectId:"voter-ccc7c",storageBucket:"voter-ccc7c.appspot.com",messagingSenderId:"112218268129",appId:"1:112218268129:web:26e0a5cc6531ca010ef2a0",measurementId:"G-G0TSSSZ1GL"});var Y,J,Q,Z,H,K,X,$,ee,te,ne,re,ae,oe,ie,se,ce,ue,le,pe,be,he,de,fe,me,ve=T.a,je=0,Oe=1,ye=2,we=(Y=M.action.bound,J=M.action.bound,Q=M.action.bound,Z=M.action.bound,H=function(){function e(){Object(c.a)(this,e),Object(W.a)(this,"questionState",K,this),Object(W.a)(this,"question",X,this),Object(W.a)(this,"questionRef",$,this),Object(W.a)(this,"step",ee,this),Object(W.a)(this,"answer",te,this),this._dbUnsubscriber=void 0,this._db=void 0,Object(W.a)(this,"castVote",ne,this)}return Object(u.a)(e,[{key:"init",value:function(e,t){var n=this;this.step=e,this.userId=t,this.answer=localStorage.getItem(this.step),this._dbUnsubscriber=ve.firestore().collection("questions").where("sortOrder","==",e).limit(1).onSnapshot((function(e){if(1===e.size){n.questionRef=e.docs[0].ref;var r=e.docs[0].data();n.question=r,r.votes[t]||n.resetAnswer(),n.questionState=Oe}else n.questionState=ye,n.question=null}))}},{key:"dispose",value:function(){this._dbUnsubscriber&&(this._dbUnsubscriber(),this._dbUnsubscriber=null,console.log("disposed"))}},{key:"resetAnswer",value:function(){this.answer=null,localStorage.removeItem(this.step)}},{key:"votesCount",get:function(){var e=this,t={total:0,yes:0,no:0};return this.question?Object.keys(this.question.votes).reduce((function(t,n){var r=e.question.votes[n];return t.total++,"yes"===r?t.yes++:"no"===r&&t.no++,t}),t):t}}]),e}(),K=Object(G.a)(H.prototype,"questionState",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return je}}),X=Object(G.a)(H.prototype,"question",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=Object(G.a)(H.prototype,"questionRef",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee=Object(G.a)(H.prototype,"step",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te=Object(G.a)(H.prototype,"answer",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(G.a)(H.prototype,"votesCount",[M.computed],Object.getOwnPropertyDescriptor(H.prototype,"votesCount"),H.prototype),ne=Object(G.a)(H.prototype,"castVote",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){e.answer!==t&&ve.firestore().runTransaction((function(r){return r.get(e.questionRef).then((function(a){var o=a.data().votes;o[n]=t,r.update(e.questionRef,{votes:o}),e.answer=t,localStorage.setItem(e.step,t)}))}))}}}),Object(G.a)(H.prototype,"init",[J],Object.getOwnPropertyDescriptor(H.prototype,"init"),H.prototype),Object(G.a)(H.prototype,"dispose",[Q],Object.getOwnPropertyDescriptor(H.prototype,"dispose"),H.prototype),Object(G.a)(H.prototype,"resetAnswer",[Z],Object.getOwnPropertyDescriptor(H.prototype,"resetAnswer"),H.prototype),H),ge=(re=M.action.bound,ae=function(){function e(t){Object(c.a)(this,e),Object(W.a)(this,"step",oe,this),Object(W.a)(this,"isAuthenticated",ie,this),Object(W.a)(this,"userId",se,this)}return Object(u.a)(e,[{key:"init",value:function(){var e=Object(k.a)(S.a.mark((function e(){var t,n=this;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.auth().signInAnonymously();case 2:t=e.sent,Object(M.runInAction)((function(){n.userId=t.user.uid,n.isAuthenticated=!0})),"k1UWLoF47u9t7jVu36aR",ve.firestore().collection("steps").doc("k1UWLoF47u9t7jVu36aR").onSnapshot((function(e){var t=e.data();n.step=t.questionStep}),(function(e){console.log("ERROR",e)}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),oe=Object(G.a)(ae.prototype,"step",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ie=Object(G.a)(ae.prototype,"isAuthenticated",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),se=Object(G.a)(ae.prototype,"userId",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(G.a)(ae.prototype,"init",[re],Object.getOwnPropertyDescriptor(ae.prototype,"init"),ae.prototype),ae),Ee=(ce=M.action.bound,ue=M.action.bound,le=M.action.bound,pe=function(){function e(){Object(c.a)(this,e),Object(W.a)(this,"step",be,this),this._db=ve.firestore(),this._stepRef=void 0}return Object(u.a)(e,[{key:"init",value:function(){var e=Object(k.a)(S.a.mark((function e(){var t,n=this;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._stepRef=this._db.collection("steps").doc("k1UWLoF47u9t7jVu36aR"),e.next=3,this._stepRef.get();case 3:(t=e.sent).exists&&Object(M.runInAction)((function(){var e=t.data();n.step=e.questionStep}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"next",value:function(){var e=Object(k.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ve.firestore.FieldValue.increment(1),e.next=3,this._stepRef.update({questionStep:t});case 3:this.step++;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"previous",value:function(){var e=Object(k.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.step>0)){e.next=5;break}return t=ve.firestore.FieldValue.increment(-1),e.next=4,this._stepRef.update({questionStep:t});case 4:this.step--;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),be=Object(G.a)(pe.prototype,"step",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Object(G.a)(pe.prototype,"init",[ce],Object.getOwnPropertyDescriptor(pe.prototype,"init"),pe.prototype),Object(G.a)(pe.prototype,"next",[ue],Object.getOwnPropertyDescriptor(pe.prototype,"next"),pe.prototype),Object(G.a)(pe.prototype,"previous",[le],Object.getOwnPropertyDescriptor(pe.prototype,"previous"),pe.prototype),pe),Se=Object(x.a)({palette:{primary:F.a,secondary:N.a}}),ke=Object(h.inject)((function(e){return{viewStore:new we}}))(he=Object(h.observer)(he=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.step,n=e.viewStore,r=e.userId;n.init(t,r)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.step,r=t.viewStore,a=t.userId;e.step!==n&&(r.dispose(),r.init(n,a))}},{key:"componentWillUnmount",value:function(){this.props.viewStore.dispose()}},{key:"render",value:function(){var e,t=this.props,n=t.classes,r=t.viewStore,a=t.userId,i=r.question,s=r.questionState,c=r.castVote,u=r.answer,l=r.votesCount;if(s<1)e=o.a.createElement("div",null,"Loading...");else if(s>1)e=o.a.createElement("div",null,"The end.");else{var p=l.yes/l.total*100||0,b=l.no/l.total*100||0;e=o.a.createElement(O.a,null,o.a.createElement("h3",null,i.question),o.a.createElement(I.a,{theme:Se},o.a.createElement(R.a,{variant:"extended",size:"large",color:"primary","aria-label":"Yes",className:n.margin,disabled:"no"===u,onClick:function(e){return c("yes",a)}},o.a.createElement(U.a,{className:n.extendedIcon})," Yes"),o.a.createElement(R.a,{variant:"extended",size:"large",color:"secondary","aria-label":"Yes",className:n.margin,disabled:"yes"===u,onClick:function(e){return c("no",a)}},o.a.createElement(_.a,{className:n.extendedIcon})," No"),o.a.createElement("div",null,o.a.createElement(C.a,{className:n.card},o.a.createElement(z.a,{title:"Results"}),o.a.createElement(A.a,null,o.a.createElement(v.a,null,"Yes (",p.toFixed(0)," %)"),o.a.createElement(D.a,{color:"primary",variant:"determinate",value:p}),o.a.createElement(v.a,null,"No (",b.toFixed(0)," %)"),o.a.createElement(D.a,{color:"secondary",variant:"determinate",value:b}))))))}return e}}]),t}(o.a.Component))||he)||he,qe=Object(w.a)((function(e){return{margin:{margin:e.spacing(1)},fab:{selected:{color:"green"}},extendedIcon:{marginRight:e.spacing(2)},card:{marginTop:e.spacing(2)}}}))(ke),xe=Object(h.inject)((function(e){return{viewStore:e.rootStore.questionsStore}}))(de=Object(h.observer)(de=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=Object(k.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.viewStore.init();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.viewStore,t=e.step,n=e.isAuthenticated,r=e.userId;return n?o.a.createElement(qe,{step:t,userId:r}):o.a.createElement("div",null,o.a.createElement(q.a,null))}}]),t}(o.a.Component))||de)||de,Ie=n(122),Re=n(123),Ce=n(124),ze=n(125),Ae=Object(h.inject)((function(e){return{viewStore:new Ee}}))(fe=Object(h.observer)(fe=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=Object(k.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.viewStore.init();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.viewStore,t=e.step,n=e.next,r=e.previous;return o.a.createElement(O.a,null,o.a.createElement(v.a,{variant:"h5",component:"h3"},"Admin page"),o.a.createElement(C.a,null,o.a.createElement(z.a,{title:"Step",subheader:"Use this to change question"}),o.a.createElement(A.a,null,"Current question: ",t),o.a.createElement(Ie.a,null,o.a.createElement(Re.a,{variant:"contained",color:"default",startIcon:o.a.createElement(Ce.a,null),disabled:t<1,onClick:function(e){return r()}},"Previous question"),o.a.createElement(Re.a,{variant:"contained",color:"default",endIcon:o.a.createElement(ze.a,null),onClick:function(e){return n()}},"Next question"))))}}]),t}(o.a.Component))||fe)||fe,De={home:o.a.createElement(g,null),questions:o.a.createElement(xe,null),admin:o.a.createElement(Ae,null)},Ue=Object(h.inject)((function(e){return{routerStore:e.rootStore.routerStore}}))(me=Object(h.observer)(me=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.classes;return o.a.createElement("div",{className:e.root},o.a.createElement(f.a,{position:"static"},o.a.createElement(m.a,null,o.a.createElement(v.a,{variant:"h6",className:e.title},o.a.createElement(j.a,{style:{fontFamily:"Monoton",fontSize:"30px",textShadow:"2px 2px #ccc",textDecoration:"none"},href:"/",color:"inherit"},"Voter")),o.a.createElement(j.a,{href:"/questions",color:"inherit"},"Quiz"))),o.a.createElement(O.a,{fixed:!0},o.a.createElement(y.a,{container:!0,justify:"center",alignContent:"center"},o.a.createElement(d.RouterView,{routerStore:this.props.routerStore,viewMap:De}))))}}]),t}(o.a.Component))||me)||me,_e=Object(w.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}))(Ue);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Fe=n(58),Ne=Object(Fe.a)(),Pe=new L;new d.HistoryAdapter(Pe.routerStore,Ne).observeRouterStateChanges();var Ve=Object(x.a)({fontFamily:"Roboto, sans-serif",palette:{primary:{main:"#DC3912"},secondary:{main:"#FF9900"}}});s.a.render(o.a.createElement(I.a,{theme:Ve},o.a.createElement(h.Provider,{rootStore:Pe},o.a.createElement(_e,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[67,1,2]]]);
//# sourceMappingURL=main.e8871916.chunk.js.map